{
  "entities": [
    { "id": "goblin", "tags": ["poisoned"], "properties": { "health": 50, "poisonStacks": 3 } }
  ],
  "rules": [
    {
      "from": "#poisoned",
      "where": {
        "filter": [
          { "var": "entities" },
          { ">": [{ "var": "properties.poisonStacks" }, 0] }
        ]
      },
      "do": {
        "mut": {
          "map": [
            { "var": "entities" },
            {
              "merge": [
                { "var": "" },
                {
                  "properties": {
                    "health": { "-": [{ "var": "properties.health" }, 1] }
                  }
                }
              ]
            }
          ]
        }
      }
    }
  ]
}
